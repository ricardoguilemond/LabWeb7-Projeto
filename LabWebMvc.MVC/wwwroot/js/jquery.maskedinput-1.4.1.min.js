(function (n) { typeof define == "function" && define.amd ? define(["jquery"], n) : typeof exports == "object" ? n(require("jquery")) : n(jQuery) })(function (n) { var t = navigator.userAgent, u = /iphone/i.test(t), f = /chrome/i.test(t), i = /android/i.test(t), r; n.mask = { definitions: { "9": "[0-9]", a: "[A-Za-z]", "*": "[A-Za-z0-9]" }, autoclear: !0, dataName: "rawMaskFn", placeholder: "_" }; n.fn.extend({ caret: function (n, t) { var i; if (this.length !== 0 && !this.is(":hidden")) return typeof n == "number" ? (t = typeof t == "number" ? t : n, this.each(function () { this.setSelectionRange ? this.setSelectionRange(n, t) : this.createTextRange && (i = this.createTextRange(), i.collapse(!0), i.moveEnd("character", t), i.moveStart("character", n), i.select()) })) : (this[0].setSelectionRange ? (n = this[0].selectionStart, t = this[0].selectionEnd) : document.selection && document.selection.createRange && (i = document.selection.createRange(), n = 0 - i.duplicate().moveStart("character", -1e5), t = n + i.text.length), { begin: n, end: t }) }, unmask: function () { return this.trigger("unmask") }, mask: function (t, e) { var p, l, o, c, h, v, s, a, y; return !t && this.length > 0 ? (p = n(this[0]), y = p.data(n.mask.dataName), y ? y() : undefined) : (e = n.extend({ autoclear: n.mask.autoclear, placeholder: n.mask.placeholder, completed: null }, e), l = n.mask.definitions, o = [], c = s = t.length, h = null, n.each(t.split(""), function (n, t) { t == "?" ? (s--, c = n) : l[t] ? (o.push(new RegExp(l[t])), h === null && (h = o.length - 1), n < c && (v = o.length - 1)) : o.push(null) }), this.trigger("unmask").each(function () { function tt() { if (e.completed) { for (var n = h; n <= v; n++)if (o[n] && p[n] === w(n)) return; e.completed.call(y) } } function w(n) { return n < e.placeholder.length ? e.placeholder.charAt(n) : e.placeholder.charAt(0) } function b(n) { while (++n < s && !o[n]); return n } function ft(n) { while (--n >= 0 && !o[n]); return n } function it(n, t) { var r, i; if (!(n < 0)) { for (r = n, i = b(t); r < s; r++)if (o[r]) { if (i < s && o[r].test(p[i])) p[r] = p[i], p[i] = w(i); else break; i = b(i) } d(); y.caret(Math.max(h, n)) } } function et(n) { for (var r, u, t = n, i = w(n); t < s; t++)if (o[t]) if (r = b(t), u = p[t], p[t] = i, r < s && o[r].test(u)) i = u; else break } function ot() { var t = y.val(), n = y.caret(), i; if (a && a.length && a.length > t.length) { for (k(!0); n.begin > 0 && !o[n.begin - 1];)n.begin--; if (n.begin === 0) while (n.begin < h && !o[n.begin]) n.begin++; y.caret(n.begin, n.begin) } else { for (i = k(!0); n.begin < s && !o[n.begin];)n.begin++; y.caret(n.begin, n.begin) } tt() } function rt() { k(); y.val() != nt && y.change() } function st(n) { if (!y.prop("readonly")) { var i = n.which || n.keyCode, f, r, t; a = y.val(); i === 8 || i === 46 || u && i === 127 ? (f = y.caret(), r = f.begin, t = f.end, t - r == 0 && (r = i !== 46 ? ft(r) : t = b(r - 1), t = i === 46 ? b(t) : t), g(r, t), it(r, t - 1), n.preventDefault()) : i === 13 ? rt.call(this, n) : i === 27 && (y.val(nt), y.caret(0, k()), n.preventDefault()) } } function ht(t) { var f, r, u, e, h, c; y.prop("readonly") || (f = t.which || t.keyCode, r = y.caret(), t.ctrlKey || t.altKey || t.metaKey || f < 32) || f && f !== 13 && (r.end - r.begin != 0 && (g(r.begin, r.end), it(r.begin, r.end - 1)), u = b(r.begin - 1), u < s && (e = String.fromCharCode(f), o[u].test(e) && (et(u), p[u] = e, d(), h = b(u), i ? (c = function () { n.proxy(n.fn.caret, y, h)() }, setTimeout(c, 0)) : y.caret(h), r.begin <= v && tt())), t.preventDefault()) } function g(n, t) { for (var i = n; i < t && i < s; i++)o[i] && (p[i] = w(i)) } function d() { y.val(p.join("")) } function k(n) { for (var r = y.val(), u = -1, f, t = 0, i = 0; t < s; t++)if (o[t]) { for (p[t] = w(t); i++ < r.length;)if (f = r.charAt(i - 1), o[t].test(f)) { p[t] = f; u = t; break } if (i > r.length) { g(t + 1, s); break } } else p[t] === r.charAt(i) && i++, t < c && (u = t); return n ? d() : u + 1 < c ? e.autoclear || p.join("") === ut ? (y.val() && y.val(""), g(0, s)) : d() : (d(), y.val(y.val().substring(0, u + 1))), c ? t : h } var y = n(this), p = n.map(t.split(""), function (n, t) { if (n != "?") return l[n] ? w(t) : n }), ut = p.join(""), nt = y.val(); y.data(n.mask.dataName, function () { return n.map(p, function (n, t) { return o[t] && n != w(t) ? n : null }).join("") }); y.one("unmask", function () { y.off(".mask").removeData(n.mask.dataName) }).on("focus.mask", function () { if (!y.prop("readonly")) { clearTimeout(r); var n; nt = y.val(); n = k(); r = setTimeout(function () { y.get(0) === document.activeElement && (d(), n == t.replace("?", "").length ? y.caret(0, n) : y.caret(n)) }, 10) } }).on("blur.mask", rt).on("keydown.mask", st).on("keypress.mask", ht).on("input.mask paste.mask", function () { y.prop("readonly") || setTimeout(function () { var n = k(!0); y.caret(n); tt() }, 0) }); if (f && i) y.off("input.mask").on("input.mask", ot); k() })) } }) });